const translations = {
    en: {
        home: "Home",
        about: "About",
        services: "Services",
        portfolio: "Portfolio",
        upload: "Upload",
        contact: "Contact",
        hero_title: "Flutter + HTML/CSS/JavaScript Developer",
        hero_desc: "Building modern digital solutions with 4 years of experience in Flutter and Web Development.",
        cta_portfolio: "View My Work",
        cta_contact: "Contact Me",
        about_title: "About Me",
        about_desc: "I'm Abdullah, a developer with 4 years of experience in designing and developing modern digital solutions using Flutter for cross-platform apps and HTML/CSS/JavaScript for professional responsive websites. I focus on building smooth, fast interfaces with beautiful interactive animations, writing clean, organized, and scalable code.",
        skills: "Skills",
        experience: "Experience",
        download_cv: "Download CV",
        portfolio_title: "My Projects",
        search_placeholder: "Search projects...",
        all: "All",
        mobile: "Mobile App",
        web: "Website",
        upload_title: "Upload Project",
        project_name: "Project Name",
        project_desc: "Description",
        project_cat: "Category",
        project_img: "Image URL",
        project_tech: "Technologies (comma separated)",
        project_link: "Project Link",
        submit: "Upload Project",
        contact_title: "Get In Touch",
        name: "Name",
        email: "Email",
        phone: "Phone",
        message: "Message",
        send: "Send Message",
        contact_info: "Contact Information",
        email_address: "bnbmwmrnrnmb@gmail.com",
        phone_number: "07728306149 / 07882930896",
        footer: "© 2024 Abdullah Salam. All rights reserved.",
        follow_me: "Follow Me",
        apk_url: "APK Download Link (Optional)",
        download_apk: "Download APK",
        view_project: "View Project",
        // About section enhancements
        stat_years: "Years Experience",
        stat_projects: "Completed Projects",
        stat_satisfaction: "Client Satisfaction",
        stat_technologies: "Technologies",
        who_am_i: "Who Am I?",
        about_desc_2: "I specialize in creating smooth, fast interfaces with beautiful interactive animations. My code is clean, organized, and scalable, ensuring long-term maintainability and performance.",
        what_i_do: "What I Do",
        service_1: "Cross-platform mobile app development",
        service_2: "Responsive web design & development",
        service_3: "UI/UX design and prototyping",
        service_4: "Firebase integration & backend",
        service_5: "Logo design & visual identity",
        specializations: "Specializations",
        spec_mobile: "Mobile Development",
        spec_web: "Web Development",
        spec_uiux: "UI/UX Design",
        spec_backend: "Backend & APIs",
        job_title_1: "Flutter & Web Developer",
        job_desc_1: "Building cross-platform mobile apps and professional responsive websites with modern technologies and best practices.",
        job_title_2: "Full-Stack Solutions",
        job_desc_2: "Developed management systems, accounting apps, real estate platforms, construction management tools, and chat applications.",
        job_title_3: "Design & Multimedia",
        job_desc_3: "Visual identity creation, logo design, Photoshop editing, and video production for comprehensive branding solutions.",
        select_cv_lang: "Select CV Language",
        cv_arabic: "Arabic CV",
        cv_english: "English CV",
        error: "Error",
        success: "Success",
        warning: "Warning",
        info: "Info",
        projects_load_error: "Failed to load projects. Please try again later.",
        message_sent: "Message sent successfully! Thank you for contacting me.",
        message_failed: "Failed to send message. Please try again.",
        // Services Section
        services_title: "My Services",
        service_mobile_title: "Mobile App Development",
        service_mobile_desc: "Professional Flutter apps for Android & iOS with modern design and high performance",
        service_web_title: "Web Development",
        service_web_desc: "Professional responsive websites using latest technologies",
        service_design_title: "UI/UX Design",
        service_design_desc: "Professional designs with excellent user experience",
        service_branding_title: "Logo & Branding",
        service_branding_desc: "Professional logos and visual identity for your brand",
        testimonials_title: "What Clients Say",
        certificates_title: "Certificates & Achievements"
    },
    ar: {
        home: "الرئيسية",
        about: "من أنا",
        services: "خدماتي",
        portfolio: "أعمالي",
        upload: "رفع مشروع",
        contact: "تواصل معي",
        hero_title: "مطور Flutter + HTML/CSS/JavaScript",
        hero_desc: "بناء حلول رقمية حديثة بخبرة 4 سنوات في تطوير تطبيقات Flutter ومواقع الويب.",
        cta_portfolio: "تصفح أعمالي",
        cta_contact: "تواصل معي",
        about_title: "نبذة عني",
        about_desc: "أنا عبدالله، مطوّر تطبيقات ومواقع بخبرة 4 سنوات في تصميم وتطوير حلول رقمية حديثة باستخدام Flutter لبناء التطبيقات المتعددة المنصّات، وباستخدام HTML/CSS/JavaScript لبناء مواقع ويب احترافية ومتجاوبة. أركز على بناء واجهات سلسة، سريعة، وأنيميشن تفاعلي جميل، مع كتابة أكواد نظيفة ومنظمة وقابلة للتطوير.",
        skills: "المهارات",
        experience: "الخبرة",
        download_cv: "تحميل السيرة الذاتية",
        portfolio_title: "معرض المشاريع",
        search_placeholder: "ابحث عن مشروع...",
        all: "الكل",
        mobile: "تطبيق موبايل",
        web: "موقع ويب",
        upload_title: "إضافة مشروع جديد",
        project_name: "اسم المشروع",
        project_desc: "الوصف",
        project_cat: "التصنيف",
        project_img: "رابط الصورة",
        project_tech: "التقنيات (مفصولة بفاصلة)",
        project_link: "رابط المشروع",
        submit: "رفع المشروع",
        contact_title: "تواصل معي",
        name: "الاسم",
        email: "البريد الإلكتروني",
        phone: "رقم الهاتف",
        message: "الرسالة",
        send: "إرسال الرسالة",
        contact_info: "معلومات التواصل",
        email_address: "bnbmwmrnrnmb@gmail.com",
        phone_number: "07728306149 / 07882930896",
        footer: "© 2024 عبدالله سلام. جميع الحقوق محفوظة.",
        follow_me: "تابعني",
        apk_url: "رابط تحميل APK (اختياري)",
        download_apk: "تحميل APK",
        view_project: "عرض المشروع",
        // About section enhancements
        stat_years: "سنوات خبرة",
        stat_projects: "مشروع مكتمل",
        stat_satisfaction: "رضا العملاء",
        stat_technologies: "تقنيات",
        who_am_i: "من أنا؟",
        about_desc_2: "أتخصص في إنشاء واجهات سلسة وسريعة مع حركات تفاعلية جميلة. أكوادي نظيفة ومنظمة وقابلة للتوسع، مما يضمن الصيانة طويلة المدى والأداء العالي.",
        what_i_do: "ماذا أقدم",
        service_1: "تطوير تطبيقات موبايل متعددة المنصات",
        service_2: "تصميم وتطوير مواقع ويب متجاوبة",
        service_3: "تصميم واجهات المستخدم والنماذج الأولية",
        service_4: "تكامل Firebase والخوادم الخلفية",
        service_5: "تصميم شعارات والهوية البصرية",
        specializations: "التخصصات",
        spec_mobile: "تطوير تطبيقات الموبايل",
        spec_web: "تطوير مواقع الويب",
        spec_uiux: "تصميم واجهات المستخدم",
        spec_backend: "الباك اند والـ APIs",
        job_title_1: "مطور Flutter ومواقع",
        job_desc_1: "بناء تطبيقات موبايل متعددة المنصات ومواقع ويب احترافية متجاوبة باستخدام أحدث التقنيات وأفضل الممارسات.",
        job_title_2: "حلول متكاملة",
        job_desc_2: "تطوير أنظمة إدارة، تطبيقات محاسبة، منصات عقارات، أدوات إدارة مقاولات، وتطبيقات محادثة.",
        job_title_3: "التصميم والوسائط المتعددة",
        job_desc_3: "إنشاء الهوية البصرية، تصميم الشعارات، التعديل على Photoshop، وإنتاج الفيديوهات لحلول متكاملة للعلامة التجارية.",
        select_cv_lang: "اختر لغة السيرة الذاتية",
        cv_arabic: "السيرة الذاتية (عربي)",
        cv_english: "السيرة الذاتية (إنجليزي)",
        error: "خطأ",
        success: "نجاح",
        warning: "تحذير",
        info: "معلومة",
        projects_load_error: "فشل تحميل المشاريع. يرجى المحاولة مرة أخرى.",
        message_sent: "تم إرسال رسالتك بنجاح! شكراً لتواصلك.",
        message_failed: "فشل إرسال الرسالة. يرجى المحاولة مرة أخرى.",
        // Services Section
        services_title: "خدماتي",
        service_mobile_title: "تطوير تطبيقات الموبايل",
        service_mobile_desc: "تطبيقات Flutter احترافية لأندرويد وiOS بتصميم حديث وأداء عالي",
        service_web_title: "تطوير المواقع",
        service_web_desc: "مواقع ويب احترافية متجاوبة باستخدام أحدث التقنيات",
        service_design_title: "تصميم واجهات المستخدم",
        service_design_desc: "تصاميم احترافية توفر تجربة مستخدم مميزة",
        service_branding_title: "الشعارات والهوية البصرية",
        service_branding_desc: "شعارات احترافية وهوية بصرية مميزة لعلامتك التجارية",
        testimonials_title: "آراء العملاء",
        certificates_title: "الشهادات والإنجازات"
    }
};

// Core UI Logic (Theme & Language) - Runs immediately
(function () {
    // State
    let currentLang = localStorage.getItem('lang') || (navigator.language.startsWith('ar') ? 'ar' : 'en');
    let currentTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');

    const html = document.documentElement;
    const themeToggle = document.getElementById('theme-toggle');
    const langToggle = document.getElementById('lang-toggle');

    // Initialize
    function initUI() {
        setTheme(currentTheme);
        setLanguage(currentLang);
        updateThemeIcon();
        updateLangToggleText();
    }

    // Theme Logic
    window.setTheme = function (theme) {
        html.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        currentTheme = theme;
        updateThemeIcon();
    }

    window.toggleTheme = function () {
        const newTheme = currentTheme === 'light' ? 'dark' : 'light';
        setTheme(newTheme);
    }

    function updateThemeIcon() {
        const themeToggle = document.getElementById('theme-toggle'); // Re-query in case it wasn't ready
        if (themeToggle) {
            themeToggle.innerHTML = currentTheme === 'light' ? '<i class="fas fa-moon"></i>' : '<i class="fas fa-sun"></i>';
        }
    }

    // Language Logic
    window.setLanguage = function (lang) {
        html.setAttribute('lang', lang);
        html.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
        localStorage.setItem('lang', lang);
        currentLang = lang;

        // Update Text
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (translations[lang] && translations[lang][key]) {
                el.textContent = translations[lang][key];
            }
        });

        document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
            const key = el.getAttribute('data-i18n-placeholder');
            if (translations[lang] && translations[lang][key]) {
                el.placeholder = translations[lang][key];
            }
        });

        updateLangToggleText();

        // Dispatch event for other scripts
        window.dispatchEvent(new CustomEvent('languageChanged', { detail: { lang } }));
    }

    window.toggleLanguage = function () {
        const newLang = currentLang === 'en' ? 'ar' : 'en';
        setLanguage(newLang);
    }

    function updateLangToggleText() {
        const langToggle = document.getElementById('lang-toggle'); // Re-query
        if (langToggle) {
            langToggle.textContent = currentLang === 'en' ? 'AR' : 'EN';
        }
    }

    // Run Init
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initUI);
    } else {
        initUI();
    }
})();
